<!DOCTYPE html>

<html>



<head>
  <title>Keywords over Time- List Chart</title>
  <style type="text/css">

     body{
        margin: 0px;
        font-family: "arial", sans-serif;

      }

       #title{

        background-color: black;
        color: white;
        padding: 10;


      }
      
     
      .svg
      {
          margin-left: -50px;
          
      }
      
         #tooltip{

        position: absolute;
        background-color: rgba(255,255,255,0.8);
        color: black;
        padding: 5;
        border: solid 1px black;
        visibility: hidden; 
        opacity: 0;
        transition: all 0.5s;
       
      }
      
  #xaxis .domain {
    fill:none;
    stroke:#000;
  }
  #xaxis text, #yaxis text {
    font-size: 12px;
  }
  .g-ListCell_3{

           float:left;
      }
 .g-ListCell_4{

           float:left;
      }
  .g-ListCell_5{

           float:left;
      }
       .g-ListCell_6{

           float:left;
      }
      
 .g-ListCell_5{

           float:left;
      }
  .g-ListCell.g-quantitative{

           float:left;
      }
      #yearSelect{

        margin-left: 30;

      }

      #grid, #pager {
  position: fixed;
  width: 100%;
}

  </style>
</head>
<body>

 <div id="title">
      <h1 style="color: white">Keywords over time - Restaurants from Philadelphia </h1>
    </div>

     
   <div id="tooltip">Tooltip</div>

  <div>
      <div id="listChat">
      <div id="example" class="parcoords" style="width:960px;height:350px"></div>
      </div>

    
     
       <input 
      id="yearSelect"
      type="range" 
      min="2014" 
      max="2015" 
      value="2014" 
      style="width:550"
      onchange="setYear(this.value)"
      >
  </div>


    <div class="Comments" id="Comments">
    <h2> Top 5 Comments being Mentioned </h2>


     <ul class="YearlyList" id="YearlyList"></ul>

     </div>

 




  <script src="d3.v3.min.js" charset="utf-8"></script>
   <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>  
   <script src="d3.parcoords.js"></script>
<link rel="stylesheet" type="text/css" href="d3.parcoords.css">
   

  <div id="grid"></div>

 <div id="pager"></div>










  <script>


    var year = 2014;
    var month = 0;
    var topNum = 15;
    var listByMonth = true;


    var data = [];


    var YearlyList = d3.select("#YearlyList");
    var Comments = d3.select("#Comments");


    var canvasWidth = 1250;
    var canavasHeight = 30 * topNum;
    var canavasPadding = 100;
    var innerWidth = 100;



      //setYear
   function setYear(newYear){

    year = newYear;
    yearLabel.text(year);

    render(data);



   }

    function renderList(data){

     var selection = YearlyList.selectAll("li")
          .data(data , function(d) {return d.keyword});

     selection.enter()
          .append("li")
          .attr("class", "listOfItems")
          .text(function(d) {return d.keyword});
         /* .on("mouseenter", function(d,i){
              highlight(d.keyword);
          })
          .on("mouseleave", function(d,i){
            unHighlight();
          })*/
     selection.exit().remove();

      
    }




    function renderCommentText(data, orderIndex, monthIndex){




      var selection = YearlyList.selectAll("li")
          .remove()
          .data(data[orderIndex].mentioned[year][monthIndex] , function(d) {return d});
          selection.enter()
          .append("li")
          .attr("class", "listOfItems")
          .attr("id", "listOfItems")
          .text(function(d) {return d});
     

 

    }
  

    function serchForOrder(keyword, data ){


      console.log(data);

        var order = [];

         for (var i = 0, len = data.length; i < len; i++) {

<<<<<<< HEAD


            for (var j = 0, len2 = topNum; j < len2; j++) {

                  if (keyword == data[i][j]){


                      order = order.concat(j);

                      break;

                  }

 


            }
 
        
    }


          return order;
  

  }


    function renderChart(data1,data2,data3,data4,data5,data6,data7,data8,data9,data10,data11,data12,data13){




   console.log(data1);

=======
>>>>>>> 5580afc1d8cb570a0e8e806adced9013b2c35b48
       var ranking = []

      for (var i = 1, len = topNum+1; i < len; i++) {

    ranking = ranking.concat(i);
    }




      var keywords1 = []

      for (var i = 0, len = data1.length; i < len; i++) {

    keywords1 = keywords1.concat(data1[i].keyword);
    }

      var keywords2 = []

      for (var i = 0, len = data2.length; i < len; i++) {

    keywords2 = keywords2.concat(data2[i].keyword);
    }

    var keywords3 = []

      for (var i = 0, len = data3.length; i < len; i++) {

    keywords3 = keywords3.concat(data3[i].keyword);
    }

      var keywords4 = []

      for (var i = 0, len = data4.length; i < len; i++) {

    keywords4 = keywords4.concat(data4[i].keyword);
    }

      var keywords5 = []

      for (var i = 0, len = data5.length; i < len; i++) {

    keywords5 = keywords5.concat(data5[i].keyword);
    }

        
      var keywords6 = []

      for (var i = 0, len = data6.length; i < len; i++) {

    keywords6 = keywords6.concat(data6[i].keyword);
    }

      var keywords7 = []

      for (var i = 0, len = data7.length; i < len; i++) {

    keywords7 = keywords7.concat(data7[i].keyword);
    }

    var keywords8 = []

      for (var i = 0, len = data8.length; i < len; i++) {

    keywords8 = keywords8.concat(data8[i].keyword);
    }

      var keywords9 = []

      for (var i = 0, len = data9.length; i < len; i++) {

    keywords9 = keywords9.concat(data9[i].keyword);
    }

      var keywords10 = []

      for (var i = 0, len = data10.length; i < len; i++) {

    keywords10 = keywords10.concat(data10[i].keyword);
    }
   var keywords11 = []

      for (var i = 0, len = data11.length; i < len; i++) {

    keywords11 = keywords11.concat(data11[i].keyword);
    }

      var keywords12 = []

      for (var i = 0, len = data12.length; i < len; i++) {

    keywords12 = keywords12.concat(data12[i].keyword);
    }
  

     var keywords13 = []

      for (var i = 0, len = data13.length; i < len; i++) {

    keywords13 = keywords13.concat(data13[i].keyword);
    }



    var keywordsAll = [[]]

        keywordsAll[0] =  keywords1;
        keywordsAll[1] =  keywords2;
        keywordsAll[2] =  keywords3;
        keywordsAll[3] =  keywords4;
        keywordsAll[4] =  keywords5;
        keywordsAll[5] =  keywords6;
        keywordsAll[6] =  keywords7;
         keywordsAll[7] =  keywords8;
          keywordsAll[8] =  keywords9;
           keywordsAll[9] =  keywords10;
              keywordsAll[10] =  keywords11;
               keywordsAll[11] =  keywords12;
  /*
            keywordsAll =  keywordsAll.concat(keywords2) ;
                keywordsAll =  keywordsAll.concat(keywords3) ;
                    keywordsAll =  keywordsAll.concat(keywords4) ;
                        keywordsAll =  keywordsAll.concat(keywords5) ;
                            keywordsAll =  keywordsAll.concat(keywords6) ;
                                keywordsAll =  keywordsAll.concat(keywords7) ;
                                    keywordsAll =  keywordsAll.concat(keywords8) ;
                                        keywordsAll =  keywordsAll.concat(keywords9) ;
                                            keywordsAll =  keywordsAll.concat(keywords10) ;
                                                keywordsAll =  keywordsAll.concat(keywords11) ;
                                                    keywordsAll =  keywordsAll.concat(keywords12) ;
 */

                                  console.log(keywordsAll);
  
      var frequencies1 = []

      for (var i = 0, len = data1.length; i < len; i++) {

        if (listByMonth){

        frequencies1 = frequencies1.concat(data1[i].year[year][month]);
        }
        else
        frequencies1 = frequencies1.concat(d3.sum(data1[i].year[year]));

    }


      var frequencies2 = []

      for (var i = 0, len = data2.length; i < len; i++) {

        if (listByMonth){


                  var month2 = month +1;
        
          

           frequencies2 = frequencies2.concat(data2[i].year[year][month2]);
        }
        else
        frequencies2 = frequencies2.concat(d3.sum(data2[i].year[year]));

    }

      var frequencies3 = []

      for (var i = 0, len = data3.length; i < len; i++) {

        if (listByMonth){

        var month3 = month +2;
        frequencies3 = frequencies3.concat(data3[i].year[year][month3]);
        }
        else
        frequencies3 = frequencies3.concat(d3.sum(data3[i].year[year]));

    }

      var frequencies4 = []

      for (var i = 0, len = data4.length; i < len; i++) {

        if (listByMonth){

           
              var month4 = month + 3;
          

           frequencies4 = frequencies4.concat(data4[i].year[year][month4]);
        }
        else
        frequencies4 = frequencies4.concat(d3.sum(data4[i].year[year]));

    }

      var frequencies5 = []

      for (var i = 0, len = data5.length; i < len; i++) {

        if (listByMonth){


              var month5 = month + 4;

           frequencies5 = frequencies5.concat(data5[i].year[year][month5]);
        }
        else
        frequencies5 = frequencies5.concat(d3.sum(data5[i].year[year]));

    }

         


      var frequencies6 = []

      for (var i = 0, len = data6.length; i < len; i++) {

        if (listByMonth){


                  var month6 = month + 5;
        
          

           frequencies6 = frequencies6.concat(data6[i].year[year][month6]);
        }
        else
        frequencies6 = frequencies6.concat(d3.sum(data6[i].year[year]));

    }

      var frequencies7 = []

      for (var i = 0, len = data7.length; i < len; i++) {

        if (listByMonth){
var month7=month+6;

           frequencies7 = frequencies7.concat(data7[i].year[year][month7]);
        }
        else
        frequencies7 = frequencies7.concat(d3.sum(data7[i].year[year]));

    }

      var frequencies8 = []

      for (var i = 0, len = data8.length; i < len; i++) {

        if (listByMonth){

           
              var month8 = month + 7;
          

           frequencies8 = frequencies8.concat(data8[i].year[year][month8]);
        }
        else
        frequencies8 = frequencies8.concat(d3.sum(data8[i].year[year]));

    }

      var frequencies9 = []

      for (var i = 0, len = data9.length; i < len; i++) {

        if (listByMonth){


              var month9 = month + 8;

           frequencies9 = frequencies9.concat(data9[i].year[year][month9]);
        }
        else
        frequencies9 = frequencies9.concat(d3.sum(data9[i].year[year]));

    }
        
       var frequencies10 = []

      for (var i = 0, len = data10.length; i < len; i++) {

        if (listByMonth){


            var month10 = month +9;


           frequencies10 = frequencies10.concat(data10[i].year[year][month10]);
        }
        else
        frequencies10 = frequencies10.concat(d3.sum(data10[i].year[year]));

    }
        var frequencies11 = []

      for (var i = 0, len = data11.length; i < len; i++) {

        if (listByMonth){


            var month11 = month + 10;


           frequencies11 = frequencies11.concat(data11[i].year[year][month11]);
        }
        else
        frequencies11 = frequencies11.concat(d3.sum(data11[i].year[year]));

    }

        var frequencies12 = []

      for (var i = 0, len = data12.length; i < len; i++) {

        if (listByMonth){


            var month12 = month + 11;


           frequencies12 = frequencies12.concat(data12[i].year[year][month12]);
        }
        else
        frequencies12 = frequencies12.concat(d3.sum(data12[i].year[year]));

    }

      var frequencies13 = []

      for (var i = 0, len = data13.length; i < len; i++) {

        frequencies13 = frequencies13.concat(d3.sum(data13[i].year[year]));

    }





var xscale = d3.scale.linear()
            .domain([10,250])
            .range([0, 5]);

var yscale = d3.scale.linear()
            .domain([0,10])
            .range([0,250]);


   var column =   d3.select('#listChat')    
                    .append('svg')
                      .attr('id','svg')
                    .attr({'width':canvasWidth,'height':canavasHeight});





    
    var chart0 = column
          
              .append('g')
              .attr("transform", "translate(55,0)")
              .attr('id','bars0');



           var transitext0 = d3.select('#bars0')
              .selectAll('text')
              .data(ranking)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'15px', 'font-weight' : 'bold'});



  var xLabel0 = column          
                 .append("text")
                 .style({'float': 'left', 'transform' : 'rotate(90deg)', 'transform-origin ': 'left top 0'})  
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(0,500)")  // centre below axis
                 .text("Ranking");
  

 console.log(frequencies1);
    
    var chart1 = column
            

              .append('g')
              .attr("transform", "translate(80,0)")
              .attr('id','bars1')

              .selectAll('rect')
             
              .data(frequencies1)
              .enter()
            

              .append('rect')
              .attr('id','rect1')

              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });

                
              


          var transit1 = chart1
                .data(frequencies1)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext1 = d3.select('#bars1')
              .selectAll('text')
              .data(keywords1)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});


                  transitext1.on("click",function(d,i){


                 var orders =  serchForOrder(data1[i].keyword,keywordsAll);

                 console.log(orders);

                 console.log(d3.select("#bars2:nth-child("+ orders[1] + ")"));

                 var rect = d3.select("#bars2:nth-child("+ orders[1] + ")");
                 var offsetLeft = d3.select("#bars2:nth-child("+ orders[1] + ")").offsetLeft;

                   console.log("rect: " + rect);
                  console.log("offsetLeft: " + offsetLeft);




                  renderCommentText(data1 ,i, 0);
            
              });   
  
            
              transitext1.data(frequencies1)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect1:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect1:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel1 = d3.select('#bars1')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Jan");
  







 console.log(frequencies2);
    
    var chart2 = column
              .append('g')
              .attr("transform", "translate(160,0)")
              .attr('id','bars2')
              .selectAll('rect')
              .data(frequencies1)
              .enter()
              .append('rect')
              .attr('id','rect2')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });


          var transit2 = chart2
                .data(frequencies2)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext2 = d3.select('#bars2')
              .selectAll('text')
              .data(keywords2)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});

                transitext2.on("click",function(d,i){
                  renderCommentText(data2 ,i, 1);
            
              });   


        

              transitext2.data(frequencies2)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect2:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect2:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel2 = d3.select('#bars2')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Feb");
  



  console.log(frequencies3);

   var chart3 = column
              .append('g')
              .attr("transform", "translate(240,0)")
              .attr('id','bars3')
              .selectAll('rect')
              .data(frequencies1)
              .enter()
              .append('rect')
              .attr('id','rect3')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });


          var transit3 = chart3
                .data(frequencies3)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext3 = d3.select('#bars3')
              .selectAll('text')
              .data(keywords3)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});


                 transitext3.on("click",function(d,i){
                  renderCommentText(data3 ,i, 2);
            
              });  

              transitext3.data(frequencies3)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect3:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect3:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel3 = d3.select('#bars3')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Mar");
  


console.log(frequencies4);

   var chart4 = column
              .append('g')
              .attr("transform", "translate(320,0)")
              .attr('id','bars4')
              .selectAll('rect')
              .data(frequencies4)
              .enter()
              .append('rect')
              .attr('id','rect4')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });

    

          var transit4 = chart4
                .data(frequencies4)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext4 = d3.select('#bars4')
              .selectAll('text')
              .data(keywords4)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});

              transitext4.on("click",function(d,i){
                  renderCommentText(data4 ,i, 3);
            
              });  

              transitext4.data(frequencies4)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect4:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect4:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel4 = d3.select('#bars4')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Apr");
  



console.log(frequencies5);

   var chart5 = column
              .append('g')
              .attr("transform", "translate(400,0)")
              .attr('id','bars5')
              .selectAll('rect')
              .data(frequencies5)
              .enter()
              .append('rect')
              .attr('id','rect5')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });

                
              chart5.on("click",function(d){
                alert('Interaction');
              });   


          var transit5 = chart5
                .data(frequencies5)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext5 = d3.select('#bars5')
              .selectAll('text')
              .data(keywords5)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});




              transitext5.on("click",function(d,i){
                  renderCommentText(data5 ,i, 4);
            
              });   

              transitext5.data(frequencies5)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect5:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect5:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel5 = d3.select('#bars5')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("May");


console.log(frequencies6);

   var chart6 = column
              .append('g')
              .attr("transform", "translate(480,0)")
              .attr('id','bars6')
              .selectAll('rect')
              .data(frequencies6)
              .enter()
              .append('rect')
              .attr('id','rect6')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });

                

          var transit6 = chart6
                .data(frequencies6)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext6 = d3.select('#bars6')
              .selectAll('text')
              .data(keywords6)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});


              transitext6.on("click",function(d,i){
                  renderCommentText(data6 ,i, 5);
            
              });   


              transitext6.data(frequencies6)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect6:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect6:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel6 = d3.select('#bars6')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Jun");




  console.log(frequencies7);

   var chart7 = column
              .append('g')
              .attr("transform", "translate(560,0)")
              .attr('id','bars7')
              .selectAll('rect')
              .data(frequencies7)
              .enter()
              .append('rect')
              .attr('id','rect7')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });


          var transit7 = chart7
                .data(frequencies7)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext7 = d3.select('#bars7')
              .selectAll('text')
              .data(keywords7)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});


              transitext7.on("click",function(d,i){
                  renderCommentText(data7 ,i, 6);
            
              });   


              transitext7.data(frequencies7)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect7:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect7:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel7 = d3.select('#bars7')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Jul");




console.log(frequencies8);

   var chart8 = column
              .append('g')
              .attr("transform", "translate(640,0)")
              .attr('id','bars8')
              .selectAll('rect')
              .data(frequencies8)
              .enter()
              .append('rect')
              .attr('id','rect8')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });

                 


          var transit8 = chart8
                .data(frequencies8)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext8 = d3.select('#bars8')
              .selectAll('text')
              .data(keywords8)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});



              transitext8.on("click",function(d,i){
                  renderCommentText(data8 ,i, 7);
            
              });   

              transitext8.data(frequencies8)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect8:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect8:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel8 = d3.select('#bars8')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Aug");



   console.log(frequencies9);

   var chart9 = column
              .append('g')
              .attr("transform", "translate(720,0)")
              .attr('id','bars9')
              .selectAll('rect')
              .data(frequencies9)
              .enter()
              .append('rect')
              .attr('id','rect9')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });



          var transit9 = chart9
                .data(frequencies9)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext9 = d3.select('#bars9')
              .selectAll('text')
              .data(keywords9)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});

              transitext9.on("click",function(d,i){
                  renderCommentText(data9 ,i, 8);
            
              });   


              transitext9.data(frequencies9)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect9:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect9:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel9 = d3.select('#bars9')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Sep");              



console.log(frequencies10);

   var chart10 = column
              .append('g')
              .attr("transform", "translate(800,0)")
              .attr('id','bars10')
              .selectAll('rect')
              .data(frequencies10)
              .enter()
              .append('rect')
              .attr('id','rect10')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });



          var transit10 = chart10
                .data(frequencies10)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext10 = d3.select('#bars10')
              .selectAll('text')
              .data(keywords10)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});



               transitext10.on("click",function(d,i){
                  renderCommentText(data10 ,i, 9);
            
              }); 

              transitext10.data(frequencies10)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect10:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect10:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel10 = d3.select('#bars10')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Oct");



                 console.log(frequencies11);

   var chart11 = column
              .append('g')
              .attr("transform", "translate(880,0)")
              .attr('id','bars11')
              .selectAll('rect')
              .data(frequencies11)
              .enter()
              .append('rect')
              .attr('id','rect11')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });



          var transit11 = chart11
                .data(frequencies11)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext11 = d3.select('#bars11')
              .selectAll('text')
              .data(keywords11)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});

              transitext11.on("click",function(d,i){
                  renderCommentText(data11 ,i, 10);
            
              }); 

              transitext11.data(frequencies11)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect11:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect11:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel11 = d3.select('#bars11')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Nov");



   console.log(frequencies12);

   var chart12 = column
              .append('g')
              .attr("transform", "translate(960,0)")
              .attr('id','bars12')
              .selectAll('rect')
              .data(frequencies12)
              .enter()
              .append('rect')
              .attr('id','rect12')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });

  


          var transit12 = chart12
                .data(frequencies12)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext12 = d3.select('#bars12')
              .selectAll('text')
              .data(keywords12)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});

              transitext12.on("click",function(d,i){
                  renderCommentText(data12 ,i, 11);
            
              }); 


              transitext12.data(frequencies12)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect12:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect12:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel12 = d3.select('#bars12')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text("Dec");





   console.log(frequencies13);

   var chart13 = column
              .append('g')
              .attr("transform", "translate(1060,0)")
              .attr('id','bars13')
              .selectAll('rect')
              .data(frequencies13)
              .enter()
              .append('rect')
              .attr('id','rect13')
              .attr('height',19)
              .attr({'x':0,'y':function(d,i){ return yscale(i)+19; }})
              .style('fill', '#8ee1ff')
              .attr('width',function(d) {return 0; });

 


          var transit13 = chart13
                .data(frequencies13)
                .transition()
                .duration(1000) 
                .attr("width", function(d) {return xscale(d ); });


           var transitext13 = d3.select('#bars13')
              .selectAll('text')
              .data(keywords13)
              .enter()
              .append('text')
              .attr({'x':0,'y':function(d,i){ return yscale(i)+35; }})
              .text(function(d){ return d; }).style({'fill':'#000','font-size':'14px'});


              transitext13.data(frequencies13)
              .on('mouseover', function(d,i){

                d3.select("#tooltip")
                .style("visibility", "visible" )
                .style("top", (d3.event.clientY)+10 + "px")
                .style("left",(d3.event.clientX) + "px")
                .style("opacity",1)
                d3.select("#tooltip").text(d);
                d3.select("#rect13:nth-child("+ (i + 1) + ")")
                 .style("fill", '#ffac8e')
               })
                
               
                .on('mouseout', function(d,i){
                  d3.select("#tooltip").style(
                    "visibility", "hidden"
                  )
                  .style("opacity",0);
                   d3.select("#rect13:nth-child("+ (i + 1) + ")")
                  .style("fill", '#8ee1ff')
              });


  var xLabel13 = d3.select('#bars13')                
                 .append("text")
                 .attr("class", "x label")
                 .attr("text-anchor", "middle")
                 .attr("transform", "translate(25,15)")  // centre below axis
                 .text(year);



    }



/*
    d3.selectAll("thead td").data(dollars);


     var tr = d3.select("tbody").selectAll("tr")
      .data(categories)
    .enter().append("tr");


    tr.append("th")
      .text(function(d) { return d.categories });




 tr.selectAll("td")
      .data(dollars)
    .enter().append("td").append("svg")
      .attr("width", 71)
      .attr("height", 12)
    .append("rect")
      .attr("height", 12)
      .attr("width", function(d) { return d * 71; });

*/



  function filteredDataByYear(data, theYear){

    var filteredDataByYear = data.filter(function(d) {



        return    d3.sum(d.year[theYear]) ;
      });


      filteredDataByYear.sort(function(a,b) { return d3.descending(d3.sum(a.year[theYear]), d3.sum(b.year[theYear]) )  });



    return filteredDataByYear.slice(0, topNum);
  }
  
  



    function filteredDataByMonth(data, theYear, theMonth){

    var filteredDataByMonth = data.filter(function(d) {

        return    d.year[theYear][theMonth];
      });



      filteredDataByMonth.sort(function(a,b) { return d3.descending(a.year[theYear][theMonth], b.year[theYear][theMonth] )  });



    return filteredDataByMonth.slice(0, topNum);
  }
 
 

   function render(data){

   
          var filteredData1;
          var filteredData2;
          var filteredData3;
          var filteredData4;
          var filteredData5;
          var filteredData6;
          var filteredData7;
          var filteredData8;
          var filteredData9;
          var filteredData10;
          var filteredData11;
          var filteredData12;
          var filteredData13;






/*
          if (listByMonth){

*/

              var month1 = month;
              var month2 = month+1;
              var month3 = month2+1;
              var month4 = month3 + 1;
              var month5 = month4 + 1;
              var month6 = month5+1;
              var month7 = month6+1;
              var month8 = month7+1;
              var month9 = month8 + 1;
              var month10 = month9 + 1;
              var month11 = month10 + 1;
              var month12 = month11 + 1;



               filteredData1 = filteredDataByMonth(data,year,month1);
               filteredData2 = filteredDataByMonth(data,year,month2);
               filteredData3 = filteredDataByMonth(data,year,month3);
               filteredData4 = filteredDataByMonth(data,year,month4);
               filteredData5 = filteredDataByMonth(data,year,month5);
               filteredData6 = filteredDataByMonth(data,year,month6);
               filteredData7 = filteredDataByMonth(data,year,month7);
               filteredData8 = filteredDataByMonth(data,year,month8);
               filteredData9 = filteredDataByMonth(data,year,month9);
               filteredData10 = filteredDataByMonth(data,year,month10);
               filteredData11 = filteredDataByMonth(data,year,month11);
               filteredData12 = filteredDataByMonth(data,year,month12);
               filteredData13 = filteredDataByYear(data, year);



    
         /* 

          }
          else {

          var year1  = year - 2;
          var year2  = year - 1;
          var year4  = year + 1; 
          var year5  = year + 2;



          filteredData1 = filteredDataByYear(data,year1);
          filteredData2 = filteredDataByYear(data,year2);
          filteredData3 = filteredDataByYear(data,year);
          filteredData4 = filteredDataByYear(data,year4);
          filteredData5 = filteredDataByYear(data,year5);
              
          
        

        }*/

           renderChart(filteredData1,filteredData2,filteredData3,filteredData4,filteredData5,filteredData6,filteredData7,filteredData8,filteredData9,filteredData10,filteredData11,filteredData12,filteredData13);
        
           //renderList(filteredData13);


    }





      d3.json("KeyWordsFrequency_Data.json", function(error,result){

      data = result;
      render(data);
    })

   


  </script>
</body>
</html>